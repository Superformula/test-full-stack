{
    "version": "2017-02-28",
    "scanIndexForward": false,
    "operation": "Query",
    #if( $context.arguments.limit > 120 )
        "limit": 120
    #elseif( $context.arguments.limit )
        "limit": $context.arguments.limit
    #else
        "limit": 6
    #end
    #if( $context.arguments.name )
        ,"index": "name-index"
        ,"query": {
            "expression": "#name = :name",
            "expressionValues": {
                ":name": $util.dynamodb.toDynamoDBJson($context.arguments.name)
            },
            "expressionNames": {
                "#name": "name"
            }
        }
    #else
        ,"index": "status-index"
        ,"query": {
            "expression": "#status = :status",
            "expressionValues": {
                ":status": { "S": "OK" }
            },
            "expressionNames": {
                "#status": "status"
            }
        }
    #end
    #if( $context.arguments.after )
        ,"nextToken": "${context.arguments.after}"
    #end
}